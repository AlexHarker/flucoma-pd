#N canvas 191 147 683 540 10;
#X obj 12 19 cnv 15 100 10 empty empty fluid.onsetslice~ 20 12 0 36
-262144 -66577 0;
#N canvas 750 160 713 331 musical_example 0;
#N canvas 765 239 407 247 drums_players 0;
#X obj 94 59 r pd-dsp-started;
#X obj 27 17 loadbang;
#X obj 27 59 soundfiler;
#X obj 28 180 *~, f 10;
#X obj 28 140 /~;
#X msg 28 121 1;
#X obj 28 161 phasor~;
#X obj 125 100 samplerate~;
#X obj 98 121 / 1;
#X obj 27 77 t b f b;
#X obj 95 77 t b b b;
#X obj 28 221 outlet~;
#X msg 27 37 read -resize ../media/Nicol-LoopE-M.wav onseltslice_drums
;
#X obj 124 154 array define onseltslice_drums;
#X obj 28 200 tabread4~ onseltslice_drums;
#X connect 0 0 10 0;
#X connect 1 0 12 0;
#X connect 2 0 9 0;
#X connect 3 0 14 0;
#X connect 4 0 6 0;
#X connect 5 0 4 0;
#X connect 6 0 3 0;
#X connect 7 0 8 1;
#X connect 8 0 4 1;
#X connect 9 0 5 0;
#X connect 9 1 3 1;
#X connect 9 1 8 0;
#X connect 9 2 7 0;
#X connect 10 0 5 0;
#X connect 10 1 8 0;
#X connect 10 2 7 0;
#X connect 12 0 2 0;
#X connect 14 0 11 0;
#X restore 28 54 pd drums_players;
#X obj 329 138 inlet;
#X obj 314 178 * 1000;
#X obj 314 158 / 1;
#X obj 314 198 delread~ \$0-latencydrums;
#X obj 216 287 dac~;
#N canvas 773 344 752 288 parameters 0;
#X floatatom 293 163 8 0 0 0 - - -;
#X floatatom 198 163 8 0 0 0 - - -;
#X floatatom 414 163 8 0 0 0 - - -;
#X obj 209 246 outlet;
#X msg 198 181 threshold \$1;
#X obj 108 25 loadbang;
#X floatatom 110 163 8 0 0 0 - - -;
#X msg 110 181 metric \$1;
#X text 13 162 0: Energy, f 17;
#X text 13 173 1: HFC, f 11;
#X text 13 184 2: SpectralFlux;
#X text 13 195 3: MKL;
#X text 13 205 4: IS, f 17;
#X text 13 215 5: Cosine, f 11;
#X text 13 226 6: PhaseDev;
#X text 13 238 7: WPhaseDev;
#X text 13 248 8: ComplexDev;
#X text 13 259 9: RComplexDev;
#X msg 293 181 minslicelength \$1;
#X msg 414 181 filtersize \$1;
#X floatatom 507 163 8 0 0 0 - - -;
#X floatatom 611 163 8 0 0 0 - - -;
#X floatatom 559 163 8 0 0 0 - - -;
#X obj 507 202 pack f f f, f 22;
#X obj 545 181 t b f;
#X obj 609 181 t b f;
#X msg 507 220 fftsettings \$1 \$2 \$3 \, getlatency;
#X obj 109 143 unpack f f f f f f f, f 84;
#X msg 108 46 0 0.5 2 5 1024 -1 -1;
#X text 308 7 a few presets to navigate;
#X msg 500 13 0 0.2 66 5 128 -1 -1;
#X msg 500 31 1 2 50 9 128 -1 -1;
#X msg 500 49 2 0.06 55 7 128 -1 -1;
#X msg 500 67 3 1.4 40 3 128 64 256;
#X msg 500 85 7 0.2 45 9 128 -1 -1;
#X msg 500 103 8 0.1 45 9 128 -1 -1;
#X msg 500 121 9 0.15 45 7 128 -1 -1;
#X connect 0 0 18 0;
#X connect 1 0 4 0;
#X connect 2 0 19 0;
#X connect 4 0 3 0;
#X connect 5 0 28 0;
#X connect 6 0 7 0;
#X connect 7 0 3 0;
#X connect 18 0 3 0;
#X connect 19 0 3 0;
#X connect 20 0 23 0;
#X connect 21 0 25 0;
#X connect 22 0 24 0;
#X connect 23 0 26 0;
#X connect 24 0 23 0;
#X connect 24 1 23 1;
#X connect 25 0 23 0;
#X connect 25 1 23 2;
#X connect 26 0 3 0;
#X connect 27 0 6 0;
#X connect 27 1 1 0;
#X connect 27 2 0 0;
#X connect 27 3 2 0;
#X connect 27 4 20 0;
#X connect 27 5 22 0;
#X connect 27 6 21 0;
#X connect 28 0 27 0;
#X connect 30 0 27 0;
#X connect 31 0 27 0;
#X connect 32 0 27 0;
#X connect 33 0 27 0;
#X connect 34 0 27 0;
#X connect 35 0 27 0;
#X connect 36 0 27 0;
#X restore 215 103 pd parameters;
#X obj 215 53 switch~;
#X obj 214 35 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X text 232 34 1) switch the processing on;
#X text 214 85 2) experiment with parameters;
#X obj 28 139 delwrite~ \$0-latencydrums 1000;
#X obj 215 138 fluid.onsetslice~;
#X connect 0 0 11 0;
#X connect 0 0 12 0;
#X connect 1 0 3 1;
#X connect 2 0 4 0;
#X connect 3 0 2 0;
#X connect 4 0 5 1;
#X connect 6 0 12 0;
#X connect 8 0 7 0;
#X connect 12 0 5 0;
#X connect 12 1 3 0;
#X restore 548 393 pd musical_example;
#X obj 96 151 phasor~ 1.11;
#X obj 96 187 clip~ 0 1;
#X obj 96 169 biquad~ 0 0 -1 1 0;
#X obj 110 208 delwrite~ \$0-latencycomp 100;
#X obj 405 310 delread~ \$0-latencycomp;
#X obj 511 173 r pd-dsp-started;
#X obj 584 213 samplerate~;
#X obj 511 191 t b b;
#X obj 405 290 * 1000;
#X obj 405 270 / 1;
#X msg 511 214 getlatency;
#X obj 46 437 snapshot~;
#X floatatom 46 462 5 0 0 0 - - -;
#X obj 56 411 metro 100;
#X obj 56 389 loadbang;
#X obj 45 339 samphold~;
#X obj 45 367 -~;
#X obj 131 342 samphold~;
#X obj 131 309 fexpr~ $y1[-1] + 1;
#X text 89 462 spectral frame accurate detection, f 71;
#X text 46 479 Once latency compensated with the delay as above \,
the detected position is always at the start of the spectral frame
in which an onset appears. Change the window size above to observe
the changes., f 95;
#X text 35 57 Spectral Difference-Based Real-Time Audio Slicer;
#X text 34 100 Real-time onset detection against a choice of metrics
, f 102;
#X floatatom 298 194 8 64 8192 0 - - -;
#X msg 298 211 fftsettings \$1 -1 -1 \, getlatency;
#X obj 298 153 loadbang;
#X msg 298 174 64;
#X obj 96 241 fluid.onsetslice~ -threshold 0.0001 -fftsettings 64;
#N canvas 0 23 450 300 (subpatch) 0;
#X obj 83 51 inlet;
#X obj 83 89 pdcontrol;
#X msg 83 71 dir 0 ../docs/fluid.onsetslice~.html;
#X msg 143 89 browse \$1;
#X connect 0 0 2 0;
#X connect 1 0 3 0;
#X connect 2 0 1 0;
#X connect 3 0 1 0;
#X restore 633 80 pd;
#X text 502 61 launch the HTML doc->;
#X obj 634 63 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X connect 2 0 4 0;
#X connect 3 0 5 0;
#X connect 3 0 29 0;
#X connect 4 0 3 0;
#X connect 6 0 19 1;
#X connect 7 0 9 0;
#X connect 8 0 11 1;
#X connect 8 0 1 0;
#X connect 9 0 12 0;
#X connect 9 1 8 0;
#X connect 10 0 6 0;
#X connect 11 0 10 0;
#X connect 12 0 29 0;
#X connect 13 0 14 0;
#X connect 15 0 13 0;
#X connect 16 0 15 0;
#X connect 17 0 18 0;
#X connect 18 0 13 0;
#X connect 19 0 18 1;
#X connect 20 0 19 0;
#X connect 20 0 17 0;
#X connect 25 0 26 0;
#X connect 26 0 29 0;
#X connect 27 0 28 0;
#X connect 28 0 25 0;
#X connect 29 0 17 1;
#X connect 29 1 11 0;
#X connect 32 0 30 0;
